@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Print.cshtml";
}



<div class="actual">
    <input type="hidden" name="name" value="@ViewBag.open_pno_popup_window__pno" id="pp_pno"/>
    <div id="tagetcode"></div>
    <div id="all_in1">
        <div class="container-fluid">
            <div class="row p-0 m-0">
                 <div class="col-md-1 all_cg">
                    <div id="barcode_url"></div>
                </div>
                <div class="col-md-2 all_cg">
                    <img src="/Content/themes/Logo-suplier_in.jpg" style="width: 100%" />
                </div>
                <div class="col-md-7 pt-4 text-center">
                    <h1 style="margin: 0; font-size: 35px;">Product Lot Infomation</h1>
                    <h2 style="font-size: 20px;" id="title_actual"></h2>
                </div>

                <div class="col-md-2 p-2" style="border-top: 1px solid; border-bottom: 1px solid">
                    <div class="row">
                        <div class="col-md-6 pt-2 text-center">
                            <p style="height: 65px;text-align: left;">Document Code</p>
                            @*<p>Serial</p>*@
                            <p style="margin:29px 0 0;text-align: left;"">Date</p>
                        </div>
                        <div class="col-md-6 pt-2 text-left">
                            <div id="barcode_actual"></div>
                            @*<div id="Serial"></div>*@
                            <div id="datetimeactual" style="text-align: center; margin-top: 10px;">
                                <script>
                                    function formatDate() {
                                        var d = new Date(),
                                            month = '' + (d.getMonth() + 1),
                                            day = '' + d.getDate(),
                                            year = d.getFullYear(),
                                            Hours = d.getHours(),
                                            Minutes = d.getMinutes();

                                        if (month.length < 2) { month = '0' + month; }
                                        if (day.length < 2) { day = '0' + day; }
                                        if (Hours < 10) { Hours = '0' + Hours; }
                                        if (Minutes < 10) Minutes = '0' + Minutes;
                                        time = Hours + ":" + Minutes;
                                        var full = year + "-" + month + "-" + day + " " + time;
                                        $("#datetimeactual").html(full);
                                    }
                                    formatDate()
                                    setInterval(formatDate, 500);
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid py-4">
            <h4>Standard</h4>
            <table id="popup_actual" class="table table-hover table-bordered table-striped" style="width: 100%">
                <thead>
                    <tr class="table-warning">
                        <th style="text-align: center !important"></th>
                        <th style="text-align: center !important">Product Code</th>
                        <th style="text-align: center !important">Product Name</th>
                        <th style="text-align: center !important">Group Qty</th>
                        <th style="text-align: center !important">Process</th>
                        <th style="text-align: center !important">Status</th>
                        <th style="text-align: center !important">Location</th>
                        <th style="text-align: center !important">Location Status</th>
                        <th style="text-align: center !important">Routing</th>
                    </tr>
                </thead>
            </table>
        </div>

        <div class="container-fluid py-4">
            <h4>Use Material</h4>
            <table id="popup_use_material" class="table table-hover table-bordered table-striped" style="width: 100%">
                <thead>
                    <tr class="table-warning">
                        <th style="text-align: center !important"> </th>
                        <th style="text-align: center !important">level </th>
                        <th style="text-align: center !important">Process </th>
                        <th style="text-align: center !important">MT ML </th>
                        <th style="text-align: center !important">MT NO </th>
                        <th style="text-align: center !important">Mt Name </th>
                        <th style="text-align: center !important">Amount Roll </th>
                        <th style="text-align: center !important">Group Qty </th>
                        <th style="text-align: center !important">Use Date </th>
                        <th style="text-align: center !important">Bobin</th>
                        <th style="text-align: center !important">Status </th>
                        <th style="text-align: center !important">Location </th>
                        <th style="text-align: center !important">Location Status</th>

                    </tr>
                </thead>
            </table>
        </div>

        <div class="container-fluid py-4">
            <h4>Work Staff</h4>
            <table id="popup_work_staff" class="table table-hover table-bordered table-striped" style="width: 100%">
                <thead>
                    <tr class="table-warning">
                        <th style="text-align: center !important"></th>
                        <th style="text-align: center !important">Process</th>
                        <th style="text-align: center !important">Staff Type</th>
                        <th style="text-align: center !important">Staff Id </th>
                        <th style="text-align: center !important">Staff Name </th>
                        <th style="text-align: center !important">Start Date </th>
                        <th style="text-align: center !important">End Date </th>

                    </tr>
                </thead>
            </table>
        </div>
        <div class="container-fluid py-4">
            <h4>Use Machine</h4>
            <table id="popup_use_machin" class="table table-hover table-bordered table-striped" style="width: 100%">
                <thead>
                    <tr class="table-warning">
                        <th style="text-align: center !important"> </th>
                        <th style="text-align: center !important">Process </th>
                        <th style="text-align: center !important">MC Type </th>
                        <th style="text-align: center !important">MC NO </th>
                        <th style="text-align: center !important">MC Name </th>
                         <th style="text-align: center !important">Start Date </th>
                        <th style="text-align: center !important">End Date </th>


                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
@*end_actual_pp*@

@*---------------------------------------------------------------------------------------------------------------------------*@

<script src="/Content/grcodejs/qrcode.js"></script>
<script>
    $(function () {

        var prd_lcd = "@ViewBag.open_prd_lcd_popup_window__prd_lcd"
        $("#title_actual").html(prd_lcd);
        var id = $('#pp_pno').val();

        var html = '<div id="code_' + id + '" class="all_cg"></div>';

        $("#barcode_actual").html(html);
        var code = new QRCode(document.getElementById("code_" + id + ""), {
            width: 80,
            height: 80,
        });
        code.makeCode(prd_lcd);


        var html_barcode_url = '<div id="code_url_' + id + '" class="all_cg"></div>';
        $("#barcode_url").html(html_barcode_url);
        var code = new QRCode(document.getElementById("code_url_" + id + ""), {
            width: 80,
            height: 80,
        });

        var link = window.location.href;
        code.makeCode(link);

        //-------------------
        var t = $('#popup_actual').DataTable({
            "processing": true,
            "ajax": {
                "url": '/fgwms/getProductInfo?pno=' + id,
                "type": "Post",
                "datatype": "json",

            },
            "searching": false,
            "paging": false,
            "bInfo": false,
            "columns": [
                { data: "pno" },
                { data: "prd_lcd" },
                { data: "product_name" },
                { data: "gr_qty", render: $.fn.dataTable.render.number(',', '.', 0, '') },
                { data: "prounit_cd" },
                { data: "status_name" },
                { data: "location_name" },
                { data: "location_status_name" },//, render: $.fn.dataTable.render.number(',', '.', 0, '')
                { data: "line_name" },
            ],
            //'rowsGroup': [0, 1, 2, 3],
            'columnDefs': [
                {
                    "targets": 0, // your case first column
                    "className": "text-left",
                    "width": "3%"
                },
                 {
                     "targets": 1, // your case first column
                     "className": "text-left",
                     "width": "35%"
                 },
                 {
                     "targets": 2,
                     "className": "text-left",
                     "width": "10%"
                 },

                   {
                       "targets": 3,
                       "className": "text-right",
                       "width": "10%"
                   },
                    {
                        "targets": 4,
                        "className": "text-left",
                        "width": "10%"
                    },
                     {
                         "targets": 5,
                         "className": "text-left",
                         "width": "10%"
                     },


            ],
            "bDestroy": true,

        });//bảng 1
        t.on('order.dt search.dt', function () {
            t.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();


        var t1 = $('#popup_use_material').DataTable({
            "processing": true,
            "orderFixed": {
                "pre": [1, 'desc']
            },
            //"order": [[ 1, "desc" ]],
            "ajax": {
                "url": '/fgwms/Get_data_use_material_lot?id=' + id,
                "type": "Post",
                "datatype": "json",

            },
            "searching": false,
            "paging": false,
            "bInfo": false,
            "columns": [

                { "data": "pmno" },
                { "data": "level" },
                { "data": "process" },
                { "data": "mt_cd" },
                { "data": "mt_no" },
                { "data": "mt_nm" },
                { "data": "amount_qty" },
                { "data": "gr_qty", render: $.fn.dataTable.render.number(',', '.', 0, '') },
                { "data": "mapping_dt" },
                { "data": "bb_no" },
                { "data": "mt_sts_cd" },
                { "data": "lct_nm" },
                { "data": "lct_sts_cd" },

            ],


            'columnDefs': [
                {
                    "targets": 0, // your case first column
                    "className": "text-center",
                    "width": "1%"
                },
                {
                    "targets": 1, // your case first column
                    "className": "text-center",
                    "width": "3%"
                },
                {
                    "targets": 2, // your case first column
                    "className": "text-center",
                    "width": "15%"
                },
                {
                    "targets": 3, // your case first column
                    "className": "text-left",
                    "width": "20%"
                },
                {
                    "targets": 4, // your case first column
                    "className": "text-left",
                    "width": "15%"
                },
                {
                    "targets": 5, // your case first column
                    "className": "text-left",
                    "width": "15%"
                },
                {
                    "targets": 6, // your case first column
                    "className": "text-right",
                    "width": "5%"
                },
                {
                    "targets": 7, // your case first column
                    "className": "text-right",
                    "width": "8%"
                },
                 {
                     "targets": 8, // your case first column
                     "className": "text-center",
                     "width": "20%"
                 },
            ],
            'rowsGroup': [1, 2, 6, 7, 8],

            "bDestroy": true,
        });//bảng 2
        t1.on('order.dt search.dt', function () {
            t1.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();

        var t2 = $('#popup_work_staff').DataTable({
            "processing": true,
            "ajax": {
                "url": '/fgwms/Get_data_work_staff_lot?id=' + id,
                "type": "Post",
                "datatype": "json",

            },
            "searching": false,
            "paging": false,
            "bInfo": false,
            "columns": [
            { "data": "psid" },
                { "data": "process" },
                { "data": "staff_tp" },
                { "data": "staff_id" },
                { "data": "staff_nm" },
                { "data": "start_dt" },
                { "data": "end_dt" },

            ],
            'rowsGroup': [1, 2, 5],
            'columnDefs': [
                {
                    "targets": 0, // your case first column
                    "className": "text-center",
                    "width": "3%"
                },
                 {
                     "targets": 4, // your case first column
                     "className": "text-left",
                     "width": "15%"
                 },
                 {
                     "targets": 5, // your case first column
                     "className": "text-center",
                     "width": "10%"
                 },

            ],
            "bDestroy": true,
        });//bảng 3
        t2.on('order.dt search.dt', function () {
            t2.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();


        var t3 = $('#popup_use_machin').DataTable({
            "processing": true,
            "ajax": {
                "url": '/fgwms/Get_data_use_machin_lot?id=' + id,
                "type": "Post",
                "datatype": "json",

            },
            "searching": false,
            "paging": false,
            "bInfo": false,
            "columns": [
                 { "data": "pmid" },
                 { "data": "prounit_cd" },
                { "data": "mc_type" },
                { "data": "mc_no" },
                { "data": "mc_nm" },
                { "data": "start_dt" },
                { "data": "end_dt" },


            ],
            'rowsGroup': [1, 2, 4],
            'columnDefs': [
                {
                    "targets": 0, // your case first column
                    "className": "text-center",
                    "width": "3%"
                },
                 {
                     "targets": 3, // your case first column
                     "className": "text-center",
                     "width": "10%"
                 },

            ],
            "bDestroy": true,
        });//bảng 4
        t3.on('order.dt search.dt', function () {
            t3.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();
    });
</script>



<style>
    .all_cg {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    div#popup_actual_wrapper {
        width: 100%;
    }
</style>
