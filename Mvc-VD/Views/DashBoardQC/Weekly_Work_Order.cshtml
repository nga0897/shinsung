@*@model IEnumerable<Mvc_VD.Models.m_order_facline_day>*@
@{
    Layout = null;
}
<link href="./../../Content/themes/bootstrap.css" rel="stylesheet" />
<link href="~/Content/Bahnschrift-Font/font.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.9.1.js"></script>

<style>
    .all {
        background: #141d31;
        height: 100vh;
    }

    .header {
        background: #d55051;
        height: 15vh;
        border-bottom-left-radius: 40px;
        border-bottom-right-radius: 40px;
        color: white;
        padding: 3vh;
    }

    .content {
        height: 85vh;
        padding-top: 4vh;
    }

    #customers {
        border-collapse: collapse;
        width: 90%;
        margin: 0 auto;
        text-align: center;
        background: #d9d9d9;
    }

        #customers td, #customers th {
            border: 1px solid #797272;
            padding: 8px;
        }

    tr:nth-child(2) {
        font-size: 1vw;
        color: black;
    }

    #customers th {
        padding-top: 12px;
        padding-bottom: 12px;
        text-align: center;
        color: black;
        font-size: 1vw;
    }

    #customers td {
        font-size: 0.8vw;
    }

    .all {
        font-family: Bahns;
        margin: 0;
    }

    h4.tieude {
        font-size: 3vw;
        text-align: center;
    }

    .thoi_tiet {
        background: #a54349;
        border-radius: 10px;
        height: 9vh;
        font-size: 1.1vw;
    }

    .do_c {
        background: #7c414c;
        border-radius: 10px;
        height: 8vh;
    }

    .col-md-8.time {
        padding-left: 3vh;
    }

    .col-md-2 img {
        width: 30vh;
    }

    .col-md-2.logo {
        padding-top: 2.5vh;
    }

    label {
        color: white;
        font-size: 1vw;
    }
    /*//nhietdo*/
    div#plemx-root {
        max-height: 10vh;
        border-radius: 15px;
    }

    #plemx-root .header {
        height: 3vh;
    }

    .header a img {
        height: 2vh;
    }
    form#exportData {
    display: inline-block;
}
</style>

<div class="all">
    <input type="hidden" name="name" value="@ViewBag.start" id="ngaybd"/>
    <input type="hidden" name="name" value="@ViewBag.end" id="ngaykt"/>
    <input type="hidden" name="name" value="@ViewBag.fo_no"  id="c_fo_no"/>
    <input type="hidden" name="name" value="@ViewBag.po_no"  id="c_po_no"/>
    <input type="hidden" name="name" value="@ViewBag.style_no"  id="c_style_no"/>
    <input type="hidden" name="name" value="@ViewBag.prounit_cd"  id="c_prounit_cd"/>
    <div class="header">
        <div class="col-md-2 logo">
            <img src="/Images/Share/icon/sidemenu/Logo-suplier_in.png" class="mt-2" />
        </div>
        <div class="col-md-7">
            <h4 class="tieude">Weekly Work Order</h4>
        </div>
        <div class="col-md-2">
            <div class="thoi_tiet">
                <div class="row">
                    <div class="col-md-8 time">
                        <h3>@ViewBag.thu</h3>
                        <span class="datetime_wl"></span>
                    </div>
                    <div class="col-md-4 do_c">
                        <div id="plemx-root"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="content">
        <!-- Search function -->
        <div class="container-fluid" style="padding: 20px 6%;">
            <div class="box-body my-2 bg-white">
                <div class="container-fluid">
                    <div class="row text-right">

                             <div class="col-md-12 px-3">
                                <button id="searchBtn" class="btn btn-sm btn-primary button-srh"><i class="fa fa-search">&nbsp;Search</i></button>
                                    <form method="post" id="exportData">
                                <button type="submit" id="excelBtn" class="btn btn-sm btn-warning button-srh"><i class="fa fa-file-excel-o">&nbsp;Excel</i></button>
                                        </form>
                                   <button type="submit" class="btn btn-sm  button-back" id="back">
                                 <img src="~/Images/backbutton.png" style="width: 50%; height: 20%" />
                                 </button>
                            </div>
                           @* <div class="col-md-1 text-button">
                                
                                 <form method="post" id="exportData">
                                <button type="submit" id="excelBtn" class="btn btn-sm btn-warning button-srh"><i class="fa fa-file-excel-o">&nbsp;Excel</i></button>
                                 </form>
                                 <button type="submit" class="btn btn-sm  button-back" id="back">
                                 <img src="~/Images/backbutton.png" style="width: 50%; height: 20%" />
                                 </button>
                        </div>*@
                    </div>
                </div>
                <div class="row p-0 m-0">
                    <div class="col-md-2">
                        <div class="col-md-2 py-1 text-right">
                            <label><b>WO</b></label>
                        </div>
                        <div class="col-md-10 py-1 text-right">
                            <div class="input-group" style="width: 100%;">
                                <select id="fo_no" class="form-control">
                                    <option value="">*WO*</option>
                                </select>
                            </div>
                        </div>

                    </div>
                    <div class="col-md-1 p-1  text-right">
                        <label><b>PO</b></label>
                    </div>
                    <div class="col-md-2">
                        <div class="input-group" style="width: 100%;">
                            <select id="po_no" class="form-control">
                                <option value="">*PO*</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-1 p-1  text-right">
                        <label><b>Product</b></label>
                    </div>
                    <div class="col-md-2">
                        <div class="input-group" style="width: 100%;">
                            <select id="style_no" class="form-control">
                                <option value="">*Product*</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-1 p-1  text-right">
                        <label><b>Process</b></label>
                    </div>
                    <div class="col-md-2">
                        <div class="input-group" style="width: 100%;">
                            <select id="prounit_cd" class="form-control">
                                <option value="">*Process*</option>
                            </select>
                        </div>
                    </div>
                   
                </div>
            </div>
        </div>
        <!-- ./Search function -->
        <table id="customers">
            <tr>
                <th rowspan="2" style="background-color: #7f7f7f">NO</th>
                <th rowspan="2" style="background-color: #7f7f7f">WO</th>
                <th rowspan="2" style="background-color: #d55051">PO NO</th>
                <th rowspan="2" style="background-color: #d55051">Products</th>
                <th rowspan="2" style="background-color: #d55051">Process No</th>
                <th rowspan="2" style="background-color: #5ea54c; color: white"">Plan</th>
                <th rowspan="2" style="background-color: #5ea54c; color: white">Order</th>
                <th rowspan="2" style="background-color: #5ea54c; color: white">Done</th>
                <th rowspan="2" style="background-color: #5ea54c; color: white">Remain</th>
                @Html.Raw(ViewBag.ds_one_week)
            </tr>
            <tr>

                <td style="background-color: #7f7f7f">Mon</td>
                <td style="background-color: #7f7f7f">Tue</td>
                <td style="background-color: #7f7f7f">Wed</td>
                <td style="background-color: #7f7f7f">Thu</td>
                <td style="background-color: #7f7f7f">Fri</td>
                <td style="background-color: #7f7f7f">Sat</td>
                <td style="background-color: #7f7f7f">Sun</td>
            </tr>
            @{
                int stt = 0;
                    
            }
            @foreach (var item in Model)
            {
                stt++;
                var kq = item.prod_qty - item.done_qty;
                //var kq_tn = item.done_qty + "/" + item.prod_qty;
                var process_no = item.process_no + "-" + item.prounit_cd;
                var fo_qty = item.fo_qty;
                if (fo_qty != null)
                {
                    fo_qty = item.fo_qty;
                }
                else
                {
                    fo_qty = 0;
                }
                <tr>
                    <td>@stt</td>
                    <td>@item.fo_no</td>
                    <td>@item.po_no</td>
                    <td style="text-align: left;">@item.style_no</td>
                    <td>@process_no</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", fo_qty)</td>
                      <td style="text-align: right;">@string.Format("{0:n0}", item.prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", item.done_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", kq)</td>
       
             
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.mon_fo_qty)]     @string.Format("{0:n0}", @item.mon_done_qty) / @string.Format("{0:n0}", @item.mon_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.tue_fo_qty)]     @string.Format("{0:n0}", @item.tue_done_qty) /@string.Format("{0:n0}", @item.tue_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.wed_fo_qty)]     @string.Format("{0:n0}", @item.wed_done_qty)/ @string.Format("{0:n0}", @item.wed_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.thu_fo_qty)]     @string.Format("{0:n0}", @item.thu_done_qty) / @string.Format("{0:n0}", @item.thu_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.fri_fo_qty)]    @string.Format("{0:n0}", @item.fri_done_qty)/ @string.Format("{0:n0}", @item.fri_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.sat_fo_qty)]     @string.Format("{0:n0}", @item.sat_done_qty)/ @string.Format("{0:n0}", @item.sat_prod_qty)</td>
                    <td style="text-align: right;">[@string.Format("{0:n0}", @item.sun_fo_qty)]    @string.Format("{0:n0}", @item.sun_done_qty) / @string.Format("{0:n0}", @item.sun_prod_qty)</td>
                


                @*    <td style="text-align: right;">@string.Format("{0:n0}", @item.mon_done_qty) / @string.Format("{0:n0}", @item.mon_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.tue_done_qty) /@string.Format("{0:n0}", @item.tue_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.wed_done_qty)/ @string.Format("{0:n0}", @item.wed_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.thu_done_qty) / @string.Format("{0:n0}", @item.thu_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.fri_done_qty)/ @string.Format("{0:n0}", @item.fri_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.sat_done_qty)/ @string.Format("{0:n0}", @item.sat_prod_qty)</td>
                    <td style="text-align: right;">@string.Format("{0:n0}", @item.sun_done_qty) / @string.Format("{0:n0}", @item.sun_prod_qty)</td>*@


                    @*  @if (item.re_mark == "0.5000")
                    {
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                    @if (item.re_mark == "1.5000")
                    {
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                    @if (item.re_mark == "2.5000")
                    {
                        <td></td>
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                    @if (item.re_mark == "3.5000")
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                    @if (item.re_mark == "4.5000")
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                        <td></td>
                    }
                    @if (item.re_mark == "5.5000")
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                        <td></td>
                    }
                    @if (item.re_mark == "6.5000")
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align: right;">@kq_tn</td>
                    }*@
                </tr>
            }

        </table>

    </div>
</div>
<script>
    $(document).ready(function () {
        _getselect_wo();
        _getselect_po();
        _getselect_prounitcd();
        _getselect_style();
        $("#searchBtn").click(function () {
            var fo_no = $('#fo_no').val();
            var po_no = $('#po_no').val();
            var style_no = $('#style_no').val();
            var prounit_cd = $('#prounit_cd').val();
            $.get("/DashBoardQC/Weekly_Work_Order?fo_no=" + fo_no + "&po_no=" + po_no + "&style_no=" + style_no + "&prounit_cd=" + prounit_cd, function (html) {
                $("#noidung").html(html);
                
            });
        });
        $("#excelBtn").click(function () {
            var fo_no = $('#fo_no').val();
            var po_no = $('#po_no').val();
            var style_no = $('#style_no').val();
            var prounit_cd = $('#prounit_cd').val();
            $('#exportData').attr('action', "/DashBoardQC/ExportWeeklyWorkOrderToExcel?fo_no=" + fo_no + "&po_no=" + po_no + "&style_no=" + style_no + "&prounit_cd=" + prounit_cd);
            //$.get("/DashBoardQC/ExportWeeklyWorkOrderToExcel?fo_no=" + fo_no + "&po_no=" + po_no + "&style_no=" + style_no + "&prounit_cd=" + prounit_cd, function (html) {
            //    $("#noidung").html(html);
            //});
        });
        function _getselect_wo() {
            var start = $("#ngaybd").val();
            var end = $("#ngaykt").val(); 
            
            $.get("/DashBoardQC/getselect_wo?start=" + start + "&end=" + end, function (data) {
                if (data != null && data != undefined && data.length) {
                    var html = '';
                    html += '<option value="" selected="selected">*WO*</option>';
                    $.each(data, function (key, item) {
                        html += '<option value=' + item.fo_no + '>' + item.fo_no + '</option>';
                    });
                   
                    $("#fo_no").html(html);
                    var x_fo_no = $("#c_fo_no").val();
                    if (x_fo_no != null && x_fo_no != undefined && x_fo_no != "") {
                        $("#fo_no").val(x_fo_no);
                    }

                }
            });
        }
        function _getselect_po() {
            var start = $("#ngaybd").val();
            var end = $("#ngaykt").val();
            $.get("/DashBoardQC/getselect_po?start=" + start + "&end=" + end, function (data) {
                if (data != null && data != undefined && data.length) {
                    var html = '';
                    html += '<option value="" selected="selected">*PO*</option>';
                    $.each(data, function (key, item) {
                        html += '<option value=' + item.po_no + '>' + item.po_no + '</option>';
                    });
                    $("#po_no").html(html);
                    var x_po_no = $("#c_po_no").val();
                    if (x_po_no != null && x_po_no != undefined && x_po_no != "") {
                        $("#po_no").val(x_po_no);
                    }
                }
            });
        }
        function _getselect_prounitcd() {
            var start = $("#ngaybd").val();
            var end = $("#ngaykt").val();
            $.get("/DashBoardQC/getselect_prounitcd?start=" + start + "&end=" + end, function (data) {
                if (data != null && data != undefined && data.length) {
                    var html = '';
                    html += '<option value="" selected="selected">*Process*</option>';
                    $.each(data, function (key, item) {
                        html += '<option value=' + item.process_no + "-" + item.prounit_cd + '>' + item.process_no + "-" + item.prounit_cd + '</option>';
                    });
                    $("#prounit_cd").html(html);
                    var x_prounit_cd = $("#c_prounit_cd").val();
                    if (x_prounit_cd != null && x_prounit_cd != undefined && x_prounit_cd != "") {
                        $("#prounit_cd").val(x_prounit_cd);
                    }
                }
            });
        }
        function _getselect_style() {
            var start = $("#ngaybd").val();
            var end = $("#ngaykt").val();
            $.get("/DashBoardQC/getselect_style?start=" + start + "&end=" + end, function (data) {
                if (data != null && data != undefined && data.length) {
                    var html = '';
                    html += '<option value="" selected="selected">*Product*</option>';
                    $.each(data, function (key, item) {
                        html += '<option value=' + item.style_no + '>' + item.style_no + '</option>';
                    });
                    $("#style_no").html(html);
                    var x_style_no = $("#c_style_no").val();
                    if (x_style_no != null && x_style_no != undefined && x_style_no != "") {
                        $("#style_no").val(x_style_no);
                    }
                }
            });
        }
    });

</script>
<script type="text/javascript">
    //nhiệt dộ

    var _plm = _plm || [];
    _plm.push(['_btn', 84356]);
    _plm.push(['_loc', 'vmxx0007']);
    _plm.push(['location', document.location.host]);
    (function (d, e, i) {
        if (d.getElementById(i)) return;
        var px = d.createElement(e);
        px.type = 'text/javascript';
        px.async = true;
        px.id = i;
        px.src = ('https:' == d.location.protocol ? 'https:' : 'http:') + '//widget.twnmm.com/js/btn/pelm.js?orig=en_ca';
        var s = d.getElementsByTagName('script')[0];

        var py = d.createElement('link');
        py.rel = 'stylesheet'
        py.href = ('https:' == d.location.protocol ? 'https:' : 'http:') + '//widget.twnmm.com/styles/btn/styles.css'

        s.parentNode.insertBefore(px, s);
        s.parentNode.insertBefore(py, s);
    })(document, 'script', 'plmxbtn');

</script>
<script>
    function formatDate() {
        var d = new Date(),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear(),
            Hours = d.getHours(),
            Minutes = d.getMinutes();

        if (month.length < 2) { month = '0' + month; }
        if (day.length < 2) { day = '0' + day; }
        if (Hours < 10) { Hours = '0' + Hours; }
        if (Minutes < 10) Minutes = '0' + Minutes;
        time = Hours + ":" + Minutes;
        var full = year + "-" + month + "-" + day + " " + time;
        $(".datetime_wl").html(full);
    }
    formatDate()
    setInterval(formatDate, 500);

    $('#back').click(function () {
        window.location.href = '/Home/Dashboard';
    });


</script>
